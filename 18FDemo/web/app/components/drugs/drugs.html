<div ng-cloak ng-controller="DrugsController" class="container pull-left fill" style="min-height: 600px;">
	<div id="map" class="row">
		<div class="col-sm-3" style="border-right: 1px solid grey; min-height: 650px; padding-top: 25px">
			<div align="center">
				<img alt="logo" src="/demo/assets/img/logo.png"/><br/><br/>
			</div>
			<h4>Search Drugs</h4>
			<div class="input-group" style="width: 250px">
				<input id="suggestGeneric" type="text" class="form-control"
					ng-model="termGeneric" placeholder="Enter Keyword" ng-disabled="selecteddrugs.length >= 5"> <span
					style="width: 30px" ng-click="(termGeneric && selecteddrugs.indexOf(termGeneric) == -1)?move():0" class="input-group-addon">
					<span style="font-size: 16px; cursor: pointer;"
					class="glyphicon glyphicon-ok text-success"></span>
				</span>
			</div>
			<br/>
			<h4>Selected Drugs</h4>
			<div class="list-group" style="width: 235px">
				<div class="list-group-item" ng-if="isEmpty(selecteddrugs);">None</div>
				<div class="list-group-item row" style="margin-left: -5px" ng-if="!isEmpty(selecteddrugs);" ng-repeat="drug in selecteddrugs">
					<div class="pull-left col-sm-11" style="margin-left: -15px"><span style="text-transform: capitalize;">{{drug}}</span></div>
					<div class="pull-right"><span style="cursor: pointer;" ng-click="remove(drug);" class="glyphicon glyphicon-trash text-danger"></span></div>
				</div>
			</div>
			<div class="input-group">
				<h4>Other filters</h4>
				<div class="checkbox"><label><input type="checkbox" ng-model="country" ng-true-value="'US'" ng-false-value="''">U.S.</label></div>
			</div>
		</div>
		<div class="col-sm-9" style="padding-top: 10px;" ng-if="!isEmpty(selecteddrugs);">
			<h3>Most likely Serious Reactions/Adverse Effects for your Drugs</h3>
			<div class="alert alert-warning alert-dismissible" role="alert" style="font-size: 12px">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close" onclick="$('.alert').hide();"><span aria-hidden="true">&times;</span></button>
				<strong><span class="glyphicon glyphicon-warning-sign"></span>&nbsp;Warning message:</strong>&nbsp;This is a prototype using openFDA which is a beta research project and not for clinical use. While we make every effort to ensure that data is accurate, you should assume all results are unvalidated.
			</div>
		 	
		 	<table class="table table-striped table-bordered" style="width: 100%; border-collapse: separate;" id="tablePrimary">
				<thead>
					<tr>
						<th class="col-md-3 bg-primary">
							
							<div align="center" style="vertical-align: middle; text-align: right;padding-top: 3pxl">Drugs&nbsp;<span style="font-size: 26px;">&#8594;</span></div>
							<div align="center" style="vertical-align: middle;"><span style="font-size: 26px;">&#8595;</span> Reactions <span class="pull-right"><a href="javascript:flipTable('tablePrimary', 'tableSecondary');" style="color: white;"><img src="/demo/assets/img/transpose.gif" width="28px" height="28px" style="margin-top: 10px;"/></a></span></div>
						</th>
						<th class="bg-primary" style="vertical-align: middle;" ng-repeat="item in selecteddrugs"><span style="text-transform: capitalize;"><a target="_blank" href="http://vsearch.nlm.nih.gov/vivisimo/cgi-bin/query-meta?v%3Aproject=medlineplus&query={{item}}" style="color: white;">{{item}}</a></span></span></th>
					</tr>
				</thead>
				<tbody>	
					<tr ng-repeat="headerItem in headerItems">
						<td class="bg-primary" style="vertical-align: middle;border-bottom: medium !important;">{{headerItem.term}}<br/>({{headerItem.count | number}})</td>
						<td style="vertical-align: middle;" ng-repeat="count in finalstorage">{{count[$parent.$index] | textOrNumber}}</span></td>
					</tr>
		 		</tbody>
			</table>
			
			<table class="table table-striped table-bordered" style="width: 100%;display: none" border="0" id="tableSecondary">
				<thead>
					<tr>
						<th class="col-md-3 bg-primary">
							<div align="center" style="vertical-align: middle; text-align: right;padding-top: 3pxl">Reactions&nbsp;<span style="font-size: 26px;">&#8594;</span></div>
							<div align="center" style="vertical-align: middle;"><span style="font-size: 26px;">&#8595;</span> Drugs<span class="pull-right"><a href="javascript:flipTable('tableSecondary', 'tablePrimary');"  style="color: white;"><img src="/demo/assets/img/transpose.gif" width="28px" height="28px" style="margin-top: 10px;"/></a></span></div>
						</th>
						<th class="bg-primary" style="vertical-align: middle;" ng-repeat="headerItem in headerItems">{{headerItem.term}}<br/>({{headerItem.count | number}})</th>
					</tr>
				</thead>
				<tbody>	
					<tr ng-if="!isEmpty(selecteddrugs);" ng-repeat="item in selecteddrugs">
						<td style="vertical-align: middle;font-weight: bold;" class="text-center" class="col-md-3"><span style="text-transform: capitalize;"><a target="_blank" href="http://vsearch.nlm.nih.gov/vivisimo/cgi-bin/query-meta?v%3Aproject=medlineplus&query={{item}}">{{item}}</a></span></td>
						<td style="vertical-align: middle;" ng-repeat="count in finalstorage[$index] track by $index"><span ng-if="count != ''">{{count | number}}</span><span ng-if="count == ''">0</span></td>
					</tr>
				</tbody>
			</table >
		</div>
	</div>
</div>


<script>
    $(document).ready(function() {
		enableAutoComplete("suggestGeneric", "https://api.fda.gov/drug/label.json?limit=15&search=openfda.generic_name:");
		//enableAutoComplete("suggestBrand", "https://api.fda.gov/drug/label.json?limit=15&search=openfda.brand_name:");
    });
    
    function flipTable(tablePrimary, tableSecondary) {
	    $("#"+tablePrimary).toggle("slow", function(){
			$("#"+tableSecondary).toggle("slow");
		});
	}
</script>